<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Vote Master â€” Current Vote</title>
  <link rel="stylesheet" href="styles.css">

  <!-- QR library (optional: used if you press QR button) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
</head>
<body>
  <div class="app">

    <!-- Header -->
    <div class="card header">
      <div>
        <div class="title">Current Vote</div>
        <div class="subtitle">Cast votes</div>
      </div>
      <div>
        <button class="theme-toggle" onclick="toggleTheme()">ðŸ’¡</button>
      </div>
    </div>

    <!-- Vote Card -->
    <div id="currentCard" class="card"></div>

    <!-- Share link button -->
    <div class="card">
      <div class="row">
        <button class="btn btn-primary" onclick="openShareModal()">Get Share Link</button>
      </div>
    </div>

    <!-- Navigation -->
    <div class="card">
      <div class="row">
        <button class="btn btn-ghost" onclick="go('index.html')">Home</button>
      </div>
    </div>

  </div>

  <!-- Share Modal (custom, matches card style) -->
  <div id="shareModal" style="
    display:none;
    position:fixed;
    left:50%;
    top:50%;
    transform:translate(-50%,-50%);
    z-index:1200;
    width:90%;
    max-width:360px;
  ">
    <div style="
      background:var(--card-bg);
      color:var(--text-color);
      padding:18px;
      border-radius:14px;
      box-shadow:0 10px 30px rgba(0,0,0,0.18);
    ">
      <div style="font-weight:800; font-size:16px;">Share Vote</div>
      <div class="tiny" style="margin-top:6px; color:var(--muted-color,#666);">Add a password to protect the link (optional).</div>

      <div style="margin-top:12px;">
        <label style="display:flex; align-items:center; gap:8px;">
          <input id="shareProtectToggle" type="checkbox" onchange="document.getElementById('sharePassword').style.display = this.checked ? 'block' : 'none'">
          Protect with password
        </label>

        <input id="sharePassword" type="password" placeholder="Enter password" style="
          width:100%; display:none; margin-top:8px; padding:8px; border-radius:8px;
          background:var(--card-bg); color:var(--text-color);
        ">
      </div>

      <div style="margin-top:12px;">
        <button class="btn btn-primary" onclick="(async()=>{ await generateShareLink(); })()">Generate Link</button>
        <button class="btn btn-ghost" onclick="closeShareModal()">Close</button>
      </div>

      <div style="margin-top:12px;">
        <textarea id="shareLinkBox" style="
          width:100%; height:84px; padding:10px; border-radius:8px; resize:none;
          background:var(--card-bg); color:var(--text-color);
        " readonly></textarea>
      </div>

      <div style="display:flex; gap:8px; margin-top:10px; justify-content:flex-end;">
        <button class="btn btn-primary" onclick="copyShareLinkToClipboard()">Copy</button>
        <button class="btn btn-primary" onclick="showShareQRCode()">QR Code</button>
      </div>

      <div id="shareQR" style="display:none; margin-top:12px;"></div>
    </div>
  </div>

  <!-- Dark overlay when modal visible -->
  <div id="shareOverlay" style="
    display:none; position:fixed; left:0; top:0; width:100%; height:100%;
    background: rgba(0,0,0,0.28); z-index:1100;"></div>

  <script src="script.js"></script>

  <script>
    // nothing else needed here: script.js handles share logic and import on load
    // (we open the modal with openShareModal() which is in script.js)
  </script>
</body>
</html>
